# Ball Battle 开发日记

#### 2018.5.7
* 初始化项目
* 主界面布局
* 添加玩家组件 Ball

#### 2018.5.9
* 添加背景图片
* 更换Ball组件图片素材
* 实现移动效果
* 优化移动卡顿问题

#### 2018.5.12
* 编写工具类
* 添加生成敌人的业务逻辑
* 添加把敌人放置到地图上的业务逻辑
* 添加游戏主循环
* 抽出游戏的初始化参数，单独保存游戏参数的配置文件
* 添加生成子弹逻辑
* 监听点击事件,根据鼠标位置发射子弹

#### 2018.5.15
由于不能解决同时执行键盘按下和鼠标点击事件的处理程序的问题，改变了发射子弹的思路，由原来的"向鼠标点击的方向发射子弹"，修改为"向炮筒指向的方向发射子弹",并添加两个按钮，分别使炮筒向逆时针方向和顺时针方向旋转，具体修改内容如下:
* 给Ball添加炮筒的状态效果
* 通过键盘的Q键和E键调转炮筒的方向
* 根据当前炮筒所处角度计算子弹运动的起点与终点
* 通过键盘J键触发发射子弹的事件
* 修改地图背景的比例和尺寸
* 给小地图添加背景图片
* 根据Ball在游戏地图的位置，在小地图的相对位置生成记号点
* 重构生成敌人的过程代码,先创建敌人数组,在更新视图后给每个Enemy对象绑定对应的文档元素
* 根据Enemy的不同状态显示不同外观

#### 2018.5.16
* 增加子弹与敌人的碰撞检测
* 敌人被子弹打中时生命状态切换为死亡,死亡状态下敌人停止移动
* 增加Ball与敌人的碰撞检测
* 当Ball与死亡状态的敌人发生碰撞时,敌人消失
 ***
小结：今天重新思考代码结构,发现代码的结构越发的不清晰，在整个游戏的实现思路上有许多可以合并精简的地方，眼见整个游戏已经初具规模，所以暂时延缓一下进度，重新整理代码结构以及思路

#### 2018.5.18
经过两天的代码重构,代码结构又理清了,所有功能也都回归到重构前的正常状态,游戏中的对象都以面向对象的方式组织成了一个完整的项目,并且为之后的功能拓展增加了一些铺垫,具体内容如下：
* 把游戏中单独的对象都以类的形式实现,继承的层级清晰,代码冗余减少,基本类的拓展性增强
* 为游戏中的角色添加了血量，射程，子弹数等属性,方便之后更多功能的拓展
* 重构了发射子弹的生成逻辑,采取异步更新数据的方式进行游戏的初始化
* 优化了游戏的碰撞检测,从之前的方形检测更改为圆形检测,使检测结果与视图效果趋于一致
* 编写项目的介绍文档
 ***
 小结：两天的重构效果十分令人满意,代码的层次结构清晰可见,为之后的迭代工作扫除了很多阻碍,控制视图的方式也更加成熟,然而重构中也发现了问题,本次项目使用Vue框架进行开发，然而组织代码的方式却并没有遵循Vue的风格,可以说并没有体现出Vue框架的优势,所以之后的开发应该尽量向Vue趋近,不排除会有一次向Vue风格转型的代码重构。

#### 2018.5.19
至今为止,整个项目的基本结构都已经搭建完毕，功能也在日趋完善，与之相比，最开始启动项目设计的游戏界面就太过简陋了，于是去找素材更新了一下游戏界面,具体更新如下：
* 给整个游戏页面加上了背景图
* 更换了原本的游戏地图，以及小地图的背景图片
* 优化了每个模块的视觉效果，处理了一下之前粗糙的棱角
* 添加了新的显示玩家信息的模块，使用网络字体，以及添加了一些icon
* 重构了游戏侧边栏的布局,并且为游戏通知栏留下了布局空间
优化之后的游戏界面终于看上去更加清爽了，余下的时间处理了一直都没有解决的地图边界问题，对即将编写的新功能做了一些铺垫工作，具体更新如下：
* 缩小了整个地图的面积，添加了地图边界
* 限制游戏玩家不能越过游戏边界
* 限制敌人到达边界必须改变方向
* 编写了用于显示hp的生命条组件

 ***
 小结：优化游戏界面的工作很浪费时间，导致今天没有什么实质性的进度，在更新代码的时候也发现了几点问题
 备忘:
 * 生命条组件的尺寸不够灵活,不能适应所有使用场景
 * 生成子弹的思路仍旧存在问题,在生成子弹过多时严重占用性能

#### 2018.5.20
今天首先对生命条组件做了一点优化，可以根据不同场景展现出不同的效果,并且为游戏添加了可以在地图上随机生成补给的补给系统,具体更新如下:
* 生命条组件可接收一个字符串参数，根据不同的字符串参数显示不同的生命条尺寸
* 游戏初始化阶段在地图上随机生成补给品
* 增加了游戏角色可以拾取地图补给品的业务逻辑
* 在文件中单独提取了补给品列表，方便调整物品属性
* 玩家击杀敌人后，可以从敌人的背包中获取敌人所拾取的补给品
#### 2018.5.21
在游戏中添加了通知栏，具体更新如下:
* 在游戏中为通知栏添加相应的游戏布局
* 编写Notice类，用于存储游戏中的通知消息
 ***
 小结：
 一天满课并且还要开会,进度迟缓，罪过，罪过..
#### 2018.5.22
给补给品系统添加了爆率机制,使生成补给品的结果可控并且可配置,并且优化了子弹的生成过程,并且将子弹以补给品的形式加入到了游戏中,距离理想的效果更进了一步，:)  
具体更新如下:
* 在补给品列表中增加了相关物品的爆率属性,并根据爆率生成补给品
* 将存储游戏中所有子弹的数据结构从数组更改为列表
* 在子弹的碰撞检测中,只检测处于"飞行"状态的子弹

#### 2018.5.23
到今天为止,游戏的基本的版本已经开发完毕,基本的功能都已经具备，今天具体的更新如下：
* 给敌人添加自动攻击的逻辑,在敌人有子弹的情况下,敌人会自动攻击规定射程内的其他角色
* 给游戏添加开始和结束判定,当游戏玩家死亡或者仅剩游戏玩家一人存活时，游戏结束
* 给游戏添加开始游戏和游戏结束的相关页面布局
* 添加了显示游戏中存活人数的相关视图

 ***
 小结：今天可以算作游戏的1.0版本了,但是还有很多预想的功能还未实现，暂时准备先思考一下当前的代码,
 将现有功能的代码精简一下之后再扩充功能
